<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 ANCOVA et GLM | BIO4558 Biostatistiques appliquées avec R</title>
  <meta name="description" content="16 ANCOVA et GLM | BIO4558 Biostatistiques appliquées avec R" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="16 ANCOVA et GLM | BIO4558 Biostatistiques appliquées avec R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 ANCOVA et GLM | BIO4558 Biostatistiques appliquées avec R" />
  
  
  

<meta name="author" content="Julien Martin" />


<meta name="date" content="2019-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="define-model-to-be-bootstrapped-and-the-data-source-used.html"/>
<link rel="next" href="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quelques-points-importants-a-retenir"><i class="fa fa-check"></i>Quelques points importants à retenir</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quest-ce-que-r-et-pourquoi-lutiliser-dans-ce-cours"><i class="fa fa-check"></i>Qu’est-ce que R et pourquoi l’utiliser dans ce cours?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructions-generales-pour-les-laboratoires"><i class="fa fa-check"></i>Instructions générales pour les laboratoires</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#et-pour-les-dilettantes-ou-ceux-qui-sont-allergiques-a-la-programmation"><i class="fa fa-check"></i>Et pour les dilettantes ou ceux qui sont allergiques à la programmation…</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introductionR.html"><a href="introductionR.html"><i class="fa fa-check"></i><b>1</b> Introduction à R</a><ul>
<li class="chapter" data-level="1.1" data-path="introductionR.html"><a href="introductionR.html#importer-et-exporter-des-donnees"><i class="fa fa-check"></i><b>1.1</b> Importer et exporter des données</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introductionR.html"><a href="introductionR.html#ouvrir-et-sauvegarder-un-fichier-de-donnees-en-format-r"><i class="fa fa-check"></i><b>1.1.1</b> Ouvrir et sauvegarder un fichier de données en format R</a></li>
<li class="chapter" data-level="1.1.2" data-path="introductionR.html"><a href="introductionR.html#entrer-des-donnees"><i class="fa fa-check"></i><b>1.1.2</b> Entrer des données</a></li>
<li class="chapter" data-level="1.1.3" data-path="introductionR.html"><a href="introductionR.html#nettoyercorriger-des-donnees"><i class="fa fa-check"></i><b>1.1.3</b> Nettoyer/corriger des données</a></li>
<li class="chapter" data-level="1.1.4" data-path="introductionR.html"><a href="introductionR.html#importer-des-donnees-a-partir-dexcel."><i class="fa fa-check"></i><b>1.1.4</b> Importer des données à partir d’Excel.</a></li>
<li class="chapter" data-level="1.1.5" data-path="introductionR.html"><a href="introductionR.html#exporter-des-donnees-a-partir-de-r."><i class="fa fa-check"></i><b>1.1.5</b> Exporter des données à partir de R.</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introductionR.html"><a href="introductionR.html#examen-preliminaire-des-donnees"><i class="fa fa-check"></i><b>1.2</b> Examen préliminaire des données</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introductionR.html"><a href="introductionR.html#sommaire-statistique"><i class="fa fa-check"></i><b>1.2.1</b> Sommaire statistique</a></li>
<li class="chapter" data-level="1.2.2" data-path="introductionR.html"><a href="introductionR.html#histogramme-densite-de-probabilite-empirique-boxplot-et-examen-visuel-de-la-normalite"><i class="fa fa-check"></i><b>1.2.2</b> Histogramme, densité de probabilité empirique, boxplot et examen visuel de la normalité</a></li>
<li class="chapter" data-level="1.2.3" data-path="introductionR.html"><a href="introductionR.html#diagrammes-de-dispersion-bivaries"><i class="fa fa-check"></i><b>1.2.3</b> Diagrammes de dispersion bivariés</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introductionR.html"><a href="introductionR.html#creer-des-sous-ensembles-de-cas"><i class="fa fa-check"></i><b>1.3</b> Créer des sous-ensembles de cas</a></li>
<li class="chapter" data-level="1.4" data-path="introductionR.html"><a href="introductionR.html#transformations-de-donnees"><i class="fa fa-check"></i><b>1.4</b> Transformations de données</a></li>
<li class="chapter" data-level="1.5" data-path="introductionR.html"><a href="introductionR.html#exercice"><i class="fa fa-check"></i><b>1.5</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><i class="fa fa-check"></i><b>2</b> Analyse de puissance avec R et G*Power ahahahaha</a><ul>
<li class="chapter" data-level="2.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#la-theorie"><i class="fa fa-check"></i><b>2.1</b> La théorie</a><ul>
<li class="chapter" data-level="2.1.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#quest-ce-que-la-puissance"><i class="fa fa-check"></i><b>2.1.1</b> Qu’est-ce que la puissance?</a></li>
<li class="chapter" data-level="2.1.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#pourquoi-faire-une-analyse-de-puissance"><i class="fa fa-check"></i><b>2.1.2</b> Pourquoi faire une analyse de puissance?</a></li>
<li class="chapter" data-level="2.1.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#facteurs-qui-affectent-la-puissance"><i class="fa fa-check"></i><b>2.1.3</b> Facteurs qui affectent la puissance</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#quest-ce-que-gpower"><i class="fa fa-check"></i><b>2.2</b> Qu’est ce que G*Power?</a></li>
<li class="chapter" data-level="2.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#comment-utiliser-gpower"><i class="fa fa-check"></i><b>2.3</b> Comment utiliser G*Power</a><ul>
<li class="chapter" data-level="2.3.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#principe-general"><i class="fa fa-check"></i><b>2.3.1</b> Principe général</a></li>
<li class="chapter" data-level="2.3.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#types-danalyses-de-puissance-disponibles"><i class="fa fa-check"></i><b>2.3.2</b> Types d’analyses de puissance disponibles</a></li>
<li class="chapter" data-level="2.3.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#comment-calculer-la-taille-de-leffet-gpower-permet-de-faire-une-analyse-de-puissance-pour-de-nombreux-tests-statistiques"><i class="fa fa-check"></i><b>2.3.3</b> Comment calculer la taille de l’effet G*Power permet de faire une analyse de puissance pour de nombreux tests statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#calculs-de-puissance-pour-un-test-de-t-comparant-deux-moyennes-independantes"><i class="fa fa-check"></i><b>2.4</b> Calculs de puissance pour un test de t comparant deux moyennes indépendantes</a><ul>
<li class="chapter" data-level="2.4.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#analyse-post-hoc"><i class="fa fa-check"></i><b>2.4.1</b> Analyse post-hoc</a></li>
<li class="chapter" data-level="2.4.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#analyse-a-priori"><i class="fa fa-check"></i><b>2.4.2</b> Analyse a priori</a></li>
<li class="chapter" data-level="2.4.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#analyse-de-sensitivite"><i class="fa fa-check"></i><b>2.4.3</b> Analyse de sensitivité</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#points-a-retenir"><i class="fa fa-check"></i><b>2.5</b> Points à retenir</a></li>
<li class="chapter" data-level="2.6" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#exercice-1"><i class="fa fa-check"></i><b>2.6</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="correlation-et-regression-lineaire-simple.html"><a href="correlation-et-regression-lineaire-simple.html"><i class="fa fa-check"></i><b>3</b> Corrélation et régression linéaire simple</a></li>
<li class="chapter" data-level="4" data-path="comparaison-de-deux-echantillons.html"><a href="comparaison-de-deux-echantillons.html"><i class="fa fa-check"></i><b>4</b> Comparaison de deux échantillons</a></li>
<li class="chapter" data-level="5" data-path="anova-a-un-critere-de-classification.html"><a href="anova-a-un-critere-de-classification.html"><i class="fa fa-check"></i><b>5</b> ANOVA à un critère de classification</a></li>
<li class="chapter" data-level="6" data-path="but-first-save-current-par-and-set-graphic-page-to-hold-4.html"><a href="but-first-save-current-par-and-set-graphic-page-to-hold-4.html"><i class="fa fa-check"></i><b>6</b> but first, save current par and set graphic page to hold 4</a></li>
<li class="chapter" data-level="7" data-path="anova-a-criteres-multiples-plans-factoriels-et-hierarchiques.html"><a href="anova-a-criteres-multiples-plans-factoriels-et-hierarchiques.html"><i class="fa fa-check"></i><b>7</b> ANOVA à critères multiples : plans factoriels et hiérarchiques</a></li>
<li class="chapter" data-level="8" data-path="but-first-save-current-par-and-set-graphic-page-to-hold-4-1.html"><a href="but-first-save-current-par-and-set-graphic-page-to-hold-4-1.html"><i class="fa fa-check"></i><b>8</b> but first, save current par and set graphic page to hold 4</a></li>
<li class="chapter" data-level="9" data-path="fit-simplified-model.html"><a href="fit-simplified-model.html"><i class="fa fa-check"></i><b>9</b> fit simplified model</a></li>
<li class="chapter" data-level="10" data-path="modified-from-code-written-by-david-c-howell.html"><a href="modified-from-code-written-by-david-c-howell.html"><i class="fa fa-check"></i><b>10</b> modified from code written by David C. Howell</a></li>
<li class="chapter" data-level="11" data-path="httpwww-uvm-edudhowellstatpagesmore-stuffpermuta-.html"><a href="httpwww-uvm-edudhowellstatpagesmore-stuffpermuta-.html"><i class="fa fa-check"></i><b>11</b> <span>http://www.uvm.edu/~dhowell/StatPages/More_Stuff/Permuta-</span></a></li>
<li class="chapter" data-level="12" data-path="bootstrap-1000-time-using-the-residuals-bootstraping.html"><a href="bootstrap-1000-time-using-the-residuals-bootstraping.html"><i class="fa fa-check"></i><b>12</b> Bootstrap 1000 time using the residuals bootstraping</a></li>
<li class="chapter" data-level="13" data-path="regression-multiple.html"><a href="regression-multiple.html"><i class="fa fa-check"></i><b>13</b> Régression multiple</a></li>
<li class="chapter" data-level="14" data-path="bootstrap-analysis-the-simple-way-with-library-simpleboot.html"><a href="bootstrap-analysis-the-simple-way-with-library-simpleboot.html"><i class="fa fa-check"></i><b>14</b> Bootstrap analysis the simple way with library simpleboot</a></li>
<li class="chapter" data-level="15" data-path="define-model-to-be-bootstrapped-and-the-data-source-used.html"><a href="define-model-to-be-bootstrapped-and-the-data-source-used.html"><i class="fa fa-check"></i><b>15</b> Define model to be bootstrapped and the data source used</a></li>
<li class="chapter" data-level="16" data-path="ancova-et-glm.html"><a href="ancova-et-glm.html"><i class="fa fa-check"></i><b>16</b> ANCOVA et GLM</a></li>
<li class="chapter" data-level="17" data-path="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html"><a href="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html"><i class="fa fa-check"></i><b>17</b> Analyse de données de fréquence: Tableaux de contingence, modèles log-linéaires et régression de Poisson</a></li>
<li class="chapter" data-level="18" data-path="convert-case-form-to-table-form.html"><a href="convert-case-form-to-table-form.html"><i class="fa fa-check"></i><b>18</b> convert case form to table form</a></li>
<li class="chapter" data-level="19" data-path="fit-full-model.html"><a href="fit-full-model.html"><i class="fa fa-check"></i><b>19</b> Fit full model</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIO4558 Biostatistiques appliquées avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ancova-et-glm" class="section level1">
<h1><span class="header-section-number">16</span> ANCOVA et GLM</h1>
<p>Après avoir complété cet exercice de laboratoire, vous devriez
pouvoir:
• Utiliser R pour faire une analyse de covariance (ANCOVA) et
ajuster des modèles qui ont des variables indépendantes continues
et discontinues (GLM)
• Utiliser R pour vérifier les conditions préalables à l’ANCOVA ou
aux GLM
• Utiliser R pour comparer l’ajustement de modèles statistiques
• Utiliser R pour faire des tests de bootstrap et de permutation sur
des modèles GLM avec des variables indépendantes continues et
discontinues.
GLM
GLM est une abréviation pour General Linear Model. Les GLM sont
des modèles statistiques de la forme Y=XB+E, ou Y est un vecteur
(ou matrice) contenant la variable dépendante, B est une matrice de
paramètres estimés, et E est un vecteur (ou matrice) de résidus
homoscédastiques et normalement distribués. Tous les tests que nous
avons étudiés à date (test de t, régression linéaire simple, ANOVA à
un facteur de classification, ANOVA à plusieurs facteurs de
classification et régression multiple) sont des GLMs. Notez que tous
les modèles que nous avons rencontrés à ce jour ne contiennent qu’un
type de variable indépendante (soit continue ou discontinue). Dans cet
exercice de laboratoire, vous allez ajuster des modèles qui ont les deux
types de variables indépendantes.
ANCOVA
ANCOVA est l’abréviation pour l’analyse de covariance. C’est un type
de GLM dans lequel il y a une (ou plusieurs) variable indépendante
continue (parfois appelé la covariable) et une (ou plusieurs) variable
indépendante discontinue. Dans la présentation traditionnelle de
l’ANCOVA dans les manuels de biostatistique, le modèle ANCOVA
ne contient pas de termes d’interaction entre les variables continues et
discontinues. Par conséquent, on doit précéder l’ajustement de ce
modèle (réduit parce que sans terme d’interaction), par un test de
signification de l’interaction qui correspond à éprouver l’égalité des</p>
<p>pentes (coefficients pour la ou les variables continues) entre les
différents niveaux de la ou les variables discontinues (i.e un test
d’homogénéité des pentes).
Certaines personnes, moi y compris, utilisons le terme ANVCOVA
dans un sens plus large, pour décrire tous les modèles GLM qui
contiennent à la fois des variables continues et discontinues. Soyez
avertis toutefois que, selon l’auteur, ANCOVA peut correspondre à
un modèle GLM avec ou sans interaction.
Homogénéité des pentes
Pour répondre à de nombreuses questions biologiques, il est
nécessaire de déterminer si deux (ou plus de deux) régressions
diffèrent significativement. Par exemple, pour comparer l’efficacité de
deux insecticides on doit comparer la relation entre leur dose et la
mortalité. Ou encore, pour comparer le taux de croissance des mâles
et des femelles on doit comparer la relation entre la taille et l’âge des
mâles et des femelles.
Comme chaque régression linéaire est décrite par deux paramètres, la
pente et l’ordonnée à l’origine, on doit considérer les deux dans la
comparaison. Le modèle d’ANCOVA, à strictement parler, n’éprouve
que l’hypothèse d’égalité des ordonnées à l’origine. Cependant, avant
d’ajuster ce modèle, il faut éprouver l’hypothèse d’égalité des pentes
(homogénéité des pentes).
Cas 1 - La taille en fonction de l’âge (exemple avec pente commune)
 En utilisant les données du fichier anc1dat.Rdata , éprouvez
l’hypothèse que le taux de croissance des esturgeons mâles et femelles
de The Pas est le même (données de 1978-1980). Comme mesure du
taux de croissance, nous allons utiliser la pente de la régression du
log 10 de la longueur à la fourche, lfkl , sur le log 10 de l’âge, lage
Commençons par examiner les données. Pour faciliter la comparaison,
il serait utile de tracer la droite de régression et la trace lowess pour
ainsi plus facilement évaluer la linéarité. On peut aussi ajouter un peu
de trucs R pour obtenir des légendes plus complètes (remarquez
l’utilisation de la commande expression() pour obtenir des indices):
mydata&lt;-anc1dat
require(ggplot2)
myplot&lt;-ggplot(data=mydata, aes(x=lage,
y=log10(fklngth)))+facet_grid(.~sex)+geom_point()
myplot
myplot&lt;-myplot+</p>
<p>stat_smooth(method = lm, se=FALSE)+
stat_smooth(se=FALSE, color=“red”)
update_labels(myplot, list(
y = expression(log[10]<sub>(Fork</sub>length)),
x = expression(log[10]~(Age))
))
Figure 1.
La transformation log-log rend la relation linéaire et, à première vue, il
ne semble pas y avoir de problème évident avec les conditions
d’application. Ajustons donc le modèle complet avec l’interaction:
require(car)
model.full&lt;-lm(lfkl ~ sex + lage + sex:lage, data = mydata)
Anova(model.full, type = 3)
Anova Table (Type III tests)
Response: lfkl
Sum Sq Df F value
Pr(&gt;F)
(Intercept) 0.64444 1 794.8182 &lt; 2.2e-16 <strong><em>
sex
0.00041 1
0.5043
0.4795
lage
0.07259 1 89.5312 4.588e-15 </em></strong>
sex:lage
0.00027
1
0.3367

0.5632
Residuals
0.07135 88
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residuals 88 0.0713501 0.0008108
Probabilité que le terme lage*sex n’affecte pas la longueur à la
fourche (i.e. que la pente ne diffère pas entre les sexes, et que la
différence de taille entre les mâles et femelles ne varie pas avec l’âge)</p>
<p>Attrape. Notez que j’ai utilisé la fonction Anova() du package car avec
un “a” majuscule au lieu de la fonction native anova() (avec un “a”
minuscule&quot;) associée aux objets produits par lm() pour obtenir les
sommes de carrés de type III. Ces sommes des carrés des écarts de
type III (partiels) sont calculées comme si la variable était entrée la
dernière dans le modèle et correspondent à la différence entre la
variance expliquée par le modèle complet et par le modèle dans lequel
seule cette variable est omise. La fonction native anova() donne les
sommes des carrés séquentielles, calculées au fur et à mesure que
chaque variable est ajoutée au modèle nul avec seulement une
ordonnée à l’origine. Dans de rares cas, les sommes des carrés de type
I et III sont égales (quand le design est parfaitement orthogonal ou
balancé). Dans la vaste majorité des cas, les sommes des carrés de type
I et III sont différentes et je vous conseille de toujours utiliser les
sommes des carrés de type III dans vos analyses.
À partir de cette analyse, on devrait accepter les hypothèses nulles (1)
d’égalité des pentes pour les deux sexes, et (2) que les ordonnées à
l’origine sont les mêmes pour les deux sexes. Mais, avant d’accepter
ces conclusions, il faut vérifier si les données rencontrent les
conditions d’application, comme d’habitude…
En ce qui concerne la normalité, ça a l’air d’aller quoiqu’il
y a quelques points, en haut à droite, qui dévient de la
droite. Si on effectue le test de Wilk-Shapiro (W = .9764, p
= 0.09329), on confirme que les résidus ne dévient pas sig-
nificativement de la normalité. Les résidus semblent</p>
<p>homoscédastiques, mais si vous voulez vous en assurer, vous
pouvez l’éprouver par un des tests formels. Ici j’utilise le
test Breusch-Pagan, qui est approprié quand certaines des
variables indépendantes sont continues (Le test de Levene
n’est approprié que lorsqu’il n’y a que des variables dis-
continues).
bptest(model.full)
qui donne:
studentized Breusch-Pagan test
data: model.full
BP = 0.99979, df = 3, p-value = 0.8013
Comme l’hypothèse nulle de ce test est que les résidus sont
homoscédastiques, et que p est relativement élevé, le test confirme
l’évaluation visuelle.
De plus, il n’y a pas de tendance évidente dans les résidus, suggérant
qu’il n’y a pas de problème de linéarité. Ce qui peut également être
éprouvé formellement:
resettest(model.full, power = 2:3, type = “regressor”,
data = mydata)
RESET test
data: model.full
RESET = 0.5986, df1 = 2, df2 = 86, p-value = 0.5519
La dernière condition d’application est qu’il n’y a pas d’erreur de
mesure sur la variable indépendante continue. On ne peut vraiment
éprouver cette condition,, mais on sait que des estimés indépendants
de l’âge des poissons obtenus par différents chercheurs donnent des
âges qui concordent avec moins de 1-2 ans d’écart., ce qui est inférieur
au 10% de la fourchette observée des âges et donc acceptable pour
des analyses de modèles de type I (attention ici on ne parle pas des SC
de type I, je sais, c’est facile de confondre…)
Vous noterez qu’il y a une observation qui a un résidu normalisé
(studentized residual) qui est élevé, i.e. une valeur extrême (cas
numéro 49). Éliminez-la de l’ensemble de données et refaites l’analyse.
Vos conclusions changent-elles?
model.full.no49&lt;-lm(lfkl ~ sex + lage + sex:lage, data =
mydata[c(-49),])
Anova(model.full.no49, type=3)
Anova Table (Type III tests)
Response: lfkl
Sum Sq Df F value Pr(&gt;F)
(Intercept) 0.64255 1 895.9394 &lt;2e-16 <strong><em>
sex
0.00038 1
0.5273 0.4697
lage
0.07378 1 102.8746 &lt;2e-16 </em></strong></p>
<p>sex:lage
0.00022 1
0.3135 0.5770
Residuals
0.06239 87
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
La conclusion ne change pas après avoir enlevé la valeur extrême.
Comme on n’a pas de bonne raison d’éliminer cette valeur, il est
probablement mieux de la conserver. Un examen des conditions
d’application après avoir enlevé cette valeur révèle qu’elles sont toutes
rencontrées.
Cas 2 - Taille en fonction de l’âge (exemple avec des pentes
différentes)
 Le fichier anc3dat.Rdata contient des données sur des esturgeons
mâles de deux sites ( locate) : Lake of the Woods dans le Nord-Ouest
de l’Ontario et Chruchill River dans le Nord du Manitoba. En utilisant
la même procédure, éprouvez l’hypothèse que la pente de la régression
de lfkl sur lage est la même aux deux sites (alors Locate est la vari-
able en catégories et non pas sex ). Que concluez-vous?
mydata&lt;-anc3dat
require(ggplot2)
myplot&lt;-ggplot(data=mydata, aes(x=lage,
y=log10(fklngth)))+facet_grid(.~locate)+geom_point()
myplot
myplot&lt;-myplot+
stat_smooth(method = lm, se=FALSE)+
stat_smooth(se=FALSE, color=“red”)
update_labels(myplot, list(
y = expression(log[10]<sub>(Fork</sub>length)),
x = expression(log[10]~(Age))
))</p>
<p>Figure 2.
model.full&lt;-lm(lfkl ~ lage + locate + lage:locate, data =
mydata)
Anova(model.full, type = 3)
Anova Table (Type III tests)
Response: lfkl
Sum Sq Df F value
Pr(&gt;F)
(Intercept) 0.62951 1 1078.632 &lt; 2.2e-16 <strong><em>
lage
0.07773 1 133.185 &lt; 2.2e-16 </em></strong>
locate
0.00968 1
16.591 0.0001012 <strong><em>
lage:locate 0.00909 1
15.575 0.0001592 </em></strong>
Residuals
0.05136 88
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Ici, on rejette les hypothèses nulles (1) que les pentes sont les mêmes
dans les deux sites et (2) que les ordonnées à l’origine sont égales. En
d’autres mots, si on veut prédire la longueur à la fourche d’un
esturgeon à un âge donné précisément, il faut savoir de quel site il
provient. Puisque les pentes diffèrent, il faut estimer des régressions
séparées.</p>
<p>Mais avant d’accepter ces conclusions, on doit se convaincre que les
conditions d’application sont rencontrées:
Figure 3.
Si on examine les résidus selon les méthodes habituelles, on voit qu’il
n’y a pas de problème de linéarité, ni d’homoscédasticité (BP =
2.8721, p = 0.4118). Cependant, le test de Wilk-Shapiro est significatif
(W=0.97, p = 0.03). Étant donné la taille assez grande de l’échantillon
(N=92), ce test a beaucoup de puissance, même si la déviation de
normalité ne semble pas très grande. Compte-tenu de la robustesse
relative des GLM, de la taille de l’échantillon, on ne devrait pas ^tre
trop inquiet de cette déviation de normalité.
Donc, comme les conditions des GLM sont suffisamment remplies,
on peut accepter les résultats donnés par R. Tous les termes sont
significatifs (location, lage, interaction). Ce modèle complet est
équivalent à ajuster des régressions séparées pour chaque site. Pour
obtenir les coefficients, on peut ajuster des régressions simples sur
chaque sous-ensemble, ou extraire les coefficients ajustés du modèle
complet:
model.full
Call:
lm(formula = lfkl ~ lage + locate + lage:locate, data = mydata)
Coefficients:
(Intercept)
1.2284
lage:locateNELSON
-0.1656
lage
0.3253
locateNELSON
0.2207
Par défaut, la variable locate iest encodée comme 0 pour le site qui
vient le premier en ordre alphabétique (LofW) et 1 pour l’autre
(Nelson). Les régressions pour chaque site deviennent donc:
Pour LofW:</p>
<p>lfkl = 1.2284 + 0.3253 lage + 0.2207 (0) - 0.1656 (0) ( lage )
lfkl = 1.2284 + 0.3253 lage
Pour Nelson:
lfkl = 1.2284 + 0.3253 lage + 0.2207 (1) - 0.1656 (1) ( lage )
lfkl = 1.4491 + 0.1597 lage
Vous pouvez vérifier en ajustant séparément les régressions pour
chaque site:
by(anc3dat,locate,function(x) lm(lfkl~lage, data=x))
locate: LOFW
Call:
lm(formula = lfkl ~ lage, data = x)
Coefficients:
(Intercept)
1.2284
lage
0.3253
————————————————————
locate: NELSON
Call:
lm(formula = lfkl ~ lage, data = x)
Coefficients:
(Intercept)
1.4491
lage
0.1597
Le modèle d’ANCOVA
Si le test d’homogénéité des pentes indique qu’elles diffèrent, alors on
devrait estimer des régressions individuelles pour chaque niveau des
variables discontinues. Cependant, si on accepte l’hypothèse d’égalité
des pentes, l’étape suivante est de comparer les ordonnées à l’origine.
Selon la “vieille école” i.e. l’approche traditionnelle, on ajuste un
modèle avec la variable catégorique et la variable continue, mais sans
interaction (le modèle ANCOVA sensus stricto) et on utilise la
somme des carrés des écarts de type III, disons avec la fonction
Anova(). C’est ce que la majorité des manuels de biostatistiques
présentent
L’autre approche consiste à utiliser les résultats de l’analyse du modèle
complet, et tester la signification de chaque terme à partir des sommes
des carrés partiels. C’est plus rapide, mais moins puissant. Dans la
plupart des cas, cette perte de puissance n’est pas trop préoccupante,
sauf lorsque le modèle est très complexe et contient de nombreuses
interactions non-significatives. Je vous suggère d’utiliser l’approche
simplifiée, et de n’utiliser l’approche traditionnelle que lorsque vous
acceptez l’hypothèse d’égalité des ordonnées à l’origine. Pourquoi?</p>
<p>Puisque l’approche simplifiée est moins puissante, si vous rejetez
quand même H0, alors votre conclusion ne changera pas, mais sera
seulement renforcée, en utilisant l’approche traditionnelle.
Ici, je vais comparer l’approche traditionnelle et l’approche simplifiée.
Rappelez-vous que vous voulez évaluer l’égalité des ordonnées à
l’origine après avoir déterminé que les pentes étaient égales.
Éprouver l’égalité des ordonnées à l’origine quand les pentes diffèrent
(ou, si vous préférez, quand il y a une interaction) est rarement sensé,
peut facilement être mal interprété, et ne devrait être effectué que
rarement.
De retour aux données de anc1dat.Rdata, en comparant la relation
entre lfkl et lage entre les sexes, nous avions obtenu les résultats
suivants pour le modèle complet avec interactions:
Anova Table (Type III tests)
Response: lfkl
Sum Sq Df F value
Pr(&gt;F)
(Intercept) 0.64444 1 794.8182 &lt; 2.2e-16 <strong><em>
sex
0.00041 1
0.5043
0.4795
lage
0.07259 1 89.5312 4.588e-15 </em></strong>
sex:lage
0.00027 1
0.3367
0.5632
Residuals
0.07135 88
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residuals 88 0.0713501 0.0008108
On avait déjà conclu que la pente ne varie pas entre les sexes (i.e.
l’interaction n’est pas significative). Notez que la p-valeur associée au
sexe (0.4795) n’est pas significative non plus.
De l’autre côté, selon l’approche traditionnelle, l’inférence quand à
l’effet du sexe se fait à partir du modèle réduit (le modèle ANCOVA
sensus stricto):
model.ancova&lt;-lm(lfkl ~ sex + lage , data = mydata)
Anova(model.ancova, type = 3)
summary(model.ancova)
qui donne:
Anova Table (Type III tests)
Response: lfkl
Sum Sq Df
F value Pr(&gt;F)
(Intercept) 1.13480 1 1410.1232 &lt;2e-16 <strong><em>
sex
0.00149 1
1.8513 0.1771
lage
0.14338 1 178.1627 &lt;2e-16 </em></strong>
Residuals
0.07162 89
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Call:
lm(formula = lfkl ~ sex + lage, data = mydata)</p>
<p>Residuals:
Min
1Q
Median
-0.0939916 -0.0184574 -0.0008762
3Q
0.0224911
Max
0.0811609
Coefficients:
(Intercept)
sexMALE
lage
—
Signif. codes:
Estimate Std. Error t value Pr(&gt;|t|)
1.225533
0.032636 37.552
&lt;2e-16 <strong><em>
-0.008473
0.006228 -1.361
0.177
0.327253
0.024517 13.348
&lt;2e-16 </em></strong>
0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 0.02837 on 89 degrees of freedom
Multiple R-squared: 0.696,
Adjusted R-squared: 0.6892
F-statistic: 101.9 on 2 and 89 DF, p-value: &lt; 2.2e-16
.Dans ce modèle, sex n’est pas significatif et on conclue donc que
l’ordonnée à l’origine ne diffère pas entre les sexes. Notez que la p-
valeur est plus petite (0.1771 vs 0.4795), ce qui reflète la puissance
accrue de l’approche traditionnelle. Toutefois, les conclusions sont les
mêmes: les ordonnées à l’origine ne diffèrent pas.
(
 En examinant les graphiques diagnostiques, vous noterez qu’il y a trois
observations dont la valeur absolue du résidu est grande (cas 19, 49, et
50). Ces observations pourraient avoir un effet disproportionné sur
les résultats de l’analyse. Éliminez-les et refaites l’analyse. Les conclu-
sions changent-elles ?
model.ancova.nooutliers&lt;-lm(lfkl ~ sex + lage ,
data = mydata[c(-49, -50, -19),])
Anova(model.ancova.nooutliers, type=3)
summary(model.ancova.nooutliers)
Anova Table (Type III tests)
Response: lfkl
Sum Sq Df
F value Pr(&gt;F)
(Intercept) 1.09160 1 1896.5204 &lt; 2e-16 <strong><em>
sex
0.00232 1
4.0374 0.04764 </em>
lage
0.13992 1 243.0946 &lt; 2e-16 </strong><em>
Residuals
0.04950 86
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Call:
lm(formula = lfkl ~ sex + lage, data = mydata[c(-49, -50, -19),])
Residuals:
Min
1Q
Median
-0.0583972 -0.0184692 -0.0009756
3Q
0.0206964
Max
0.0402875
Coefficients:
(Intercept)
sexMALE
lage
—
Signif. codes:
Estimate Std. Error t value Pr(&gt;|t|)
1.224000
0.028106 43.549
&lt;2e-16 </em><strong>
-0.010823
0.005386 -2.009
0.0476 <em>
0.328604
0.021076 15.591
&lt;2e-16 </em></strong>
0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1</p>
<p>Residual standard error: 0.02399 on 86 degrees of freedom
Multiple R-squared: 0.7706,
Adjusted R-squared: 0.7653
F-statistic: 144.4 on 2 and 86 DF, p-value: &lt; 2.2e-16
Ouch! Les résultats changent. Il faudrait donc rejeter l’hypothèse nulle
et conclure que les ordonnées à l’origine diffèrent! Une conclusion
qualitativement différente de celle obtenue en considérant toutes les
données. Pourquoi? Il y a deux raisons possibles : (1) les valeurs
extrêmes influencent beaucoup les régressions ou (2) l’exclusion des
valeurs extrêmes permet d’augmenter la puissance de détection d’une
différence. La première explication est moins plausible parce que les
valeurs extrêmes n’avaient pas une grande influence (leverage faible).
Alors, la deuxième explication est plus plausible et vous pouvez le
vérifier en faisant des régressions pour chaque sexe sans et avec les
valeurs extrêmes. Si vous le faites, vous noterez que les ordonnées à
l’origine pour chaque sexe ne changent presque pas alors que leurs
erreurs-types changent beaucoup.
 Ajustez une régression simple entre lfkl et lage pour l’ensemble com-
plet de données et aussi pour le sous-ensemble sans les 3 valeurs dévi-
antes. Comparez ces modèles avec les modèles d’ANCOVA ajustés
précédemment. Que concluez-vous ? Quel modèle, d’après vous, a le
meilleur ajustement aux données ? Pourquoi ?
Le modèle en excluant les valeurs extrêmes:
model.linear.nooutliers&lt;-lm(lfkl ~ lage ,
data = mydata[c(-49, -50, -19),])
summary(model.linear.nooutliers)
Call:
lm(formula = lfkl ~ lage, data = mydata[c(-49, -50, -19), ])
Residuals:
Min
1Q
Median
-0.055567 -0.017809 -0.002944
3Q
0.021272
Max
0.044972
Coefficients:
Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.20378
0.02670
45.09
&lt;2e-16 <strong><em>
lage
0.34075
0.02054
16.59
&lt;2e-16 </em></strong>
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 0.02441 on 87 degrees of freedom
Multiple R-squared: 0.7598,
Adjusted R-squared: 0.7571
F-statistic: 275.2 on 1 and 87 DF, p-value: &lt; 2.2e-16
Pour la régression simple (sans les valeurs extrêmes) on obtient un R 2
de 0.76 et une erreur-type des résidus de 0.02441, En comparant à
l’erreur-type des résidus du modèle d’ANCOVA (0.02399) on réalise
que la qualité des prédictions est essentiellement la même, même en
ajustant des ordonnées à l’origine différentes pour chaque groupe. Par
conséquent, les bénéfices de l’inclusion d’un terme pour les</p>
<p>différentes ordonnées à l’origine sont faibles alors que le coût, en
terme de complexité du modèle, est élevé (33% d’augmentation du
nombre de termes pour un très faible amélioration de la qualité
d’ajustement). Si vous examinez les résidus de ce modèle, vous
trouverez qu’ils sont à peu près O.K.)
Si on ajuste une régression simple sur toutes les données, on obtient:
model.linear&lt;-lm(lfkl ~ lage , data = mydata)
summary(model.linear)
Call:
lm(formula = lfkl ~ lage, data = mydata)
Residuals:
Min
1Q
Median
-0.090915 -0.018975 -0.002587
3Q
0.021270
Max
0.085273
Coefficients:
Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.21064
0.03089
39.19
&lt;2e-16 <strong><em>
lage
0.33606
0.02376
14.14
&lt;2e-16 </em></strong>
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 0.0285 on 90 degrees of freedom
Multiple R-squared: 0.6897,
Adjusted R-squared: 0.6863
F-statistic: 200.1 on 1 and 90 DF, p-value: &lt; 2.2e-16
Encore une fois, l’erreur-type des résidus (0.0285) pour cette
régression unique est semblable à la variance du modèle d’ANCOVA
(0.02837) et le modèle simplifié prédit presque aussi bien que le
modèle plus complexe. (Ici encore, toutes les conditions d’application
semblent remplies, si ce n’est de la valeur extrême).
Donc, dans les deux cas (avec ou sans les valeurs extrêmes), l’addition
d’un terme supplémentaire pour le sexe n’ajoute pas grand-chose. Il
semble donc que le meilleur modèle soit celui de la régression simple.
Un estimé raisonnablement précis de la taille des esturgeons peut être
obtenu de la régression commune sur l’ensemble des résultats.
Note: Il est fréquent que l’élimination de valeurs extrêmes en fasse
apparaître d’autres. C’est parce que ces valeurs extrêmes dépendent de
la variabilité résiduelle. Si on élimine les valeurs les plus déviantes, la
variabilité résiduelle diminue, et certaines observations qui n’étaient
pas si déviantes que cela deviennent proportionnellement plus
déviantes. Notez aussi qu’en éliminant des valeurs extrêmes, l’effectif
diminue et que la puissance décroît. Il faut donc être prudent.</p>
<p>Comparer l’ajustement de modèles
Comme vous venez de le voir, le processus d’ajustement de modèles
est itératif. La plupart du temps il y a plus d’un modèle qui peut être
ajusté aux données et c’est à vous de choisir celui qui est le meilleur
compromis entre la qualité d’ajustement (qu’on essaie de maximiser)
et la complexité (qu’on essaie de minimiser). La stratégie de base en
ajustant des modèles linéaires (ANOVA, régression, ANCOVA) est
de privilégier le modèle le plus simple si la qualité d’ajustement n’est
pas significativement plus mauvaise. R peut calculer une statistique F
vous permettant de comparer l’ajustement de deux modèles. Dans ce
cas, l’hypothèse nulle est que la qualité d’ajustement ne diffère pas
entre les deux modèles.
 En utilisant les données de Anc1dat comparez l’ajustement du modèle
ANCOVA et de la régression commune:
anova(model.ancova,model.linear)
Analysis of Variance Table
Model 1: lfkl ~ sex + lage
Model 2: lfkl ~ lage
Res.Df
RSS Df Sum of Sq
F Pr(&gt;F)
1
89 0.071623
2
90 0.073113 -1 -0.001490 1.8513 0.1771
La fonction anova() utilise la différence entre la somme des carrés des
deux modèles et la divise par la différence entre le nombre de degrés
de liberté pour obtenir un carré moyen. Ce carré moyen est utilisé au
numérateur et est divisé par la variance résiduelle du modèle le plus
complexe pour obtenir la statistique F. Dans ce cas-ci, le test de F n’est
pas significatif, et on conclut que les deux modèles ont une qualité
d’ajustement équivalente, et qu’on devrait donc privilégier le modèle le
plus simple, la régression linéaire simple.
 Refaites le même processus avec le données de ANC3DAT , ajustez le
modèle complet avec interaction ( LFKL~LAGE+LOCATE+LAGE:LOCATE ) et
sans interaction ( LFKL~LAGE+LOCATE ), Comparez l’ajustement des deux
modèles, que concluez vous?
model.full.anc3dat&lt;-lm(lfkl ~ lage + locate + lage:locate,
data = anc3dat)
model.ancova.anc3dat&lt;-lm(lfkl ~ lage + locate , data =
anc3dat)
anova(model.full.anc3dat,model.ancova.anc3dat)
Analysis of Variance Table
Model 1: lfkl ~ lage + locate + lage:locate
Model 2: lfkl ~ lage + locate</p>
<p>Res.Df
RSS Df Sum of Sq
F
Pr(&gt;F)
1
88 0.051358
2
89 0.060448 -1 -0.009090 15.575 0.0001592 ***
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1
Cette fois-ci, le modèle plus complexe s’ajuste significativement mieux
aux données. (Pas surprenant puisque nous avions précédemment
conclu que l’interaction est significative avec ces données.)
Bootstrap
############################################################
######
# Bootstrap analysis
#
#
Bootstrap analysis BCa confidence intervals
Preferable when parameter distribution is far from normal
# Bootstrap 95% BCa CI for regression coefficients
library(boot)
# To simplify future modifications of the code in this file,
# copy the data to a generic mydata dataframe
mydata&lt;-anc3dat
# create a myformula variable containing the formula for the
model to be fitted
myformula&lt;-as.formula(lfkl ~ lage + locate + lage:locate)
# function to obtain regression coefficients for each itera-
tion
bs &lt;- function(formula, data, indices) {
d &lt;- data[indices, ]
fit &lt;- lm(formula, data = d)
return(coef(fit))
}
# bootstrapping with 1000 replications
results &lt;- boot(data = mydata, statistic = bs, R = 1000,
formula = myformula)
# view results
results
for (i in 1:length(results<span class="math inline">\(t0)) { plot(results, index = i) } # get 95% confidence intervals for (i in 1:length(results\)</span>t0)) {
print(boot.ci(results, type = “bca”, index = i))</p>
<p>}
Permutation test
############################################################
##########
# Permutation test
#
# using lmperm library
# To simplify future modifications of the code in this file,
# copy the data to a generic mydata dataframe
mydata&lt;-anc3dat
# create a myformula variable containing the formula for the
model to be fitted
myformula&lt;-as.formula(lfkl ~ lage + locate + lage:locate)
require(lmPerm2)
# Fit desired model on the desired dataframe
mymodel &lt;- lm(myformula , data = mydata)
# Calculate p-values for each term by permutation
# Note that lmp centers numeric variable by default, so to
get results that are
# consistent with standard models, it is necessary to set
center=FALSE
mymodelProb &lt;- lmp(myformula, data = mydata, center=FALSE,
perm = “Prob”)
summary(mymodel)
summary(mymodelProb)</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="define-model-to-be-bootstrapped-and-the-data-source-used.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
