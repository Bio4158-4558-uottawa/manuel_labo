<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 convert case form to table form | BIO4558 Biostatistiques appliquées avec R</title>
  <meta name="description" content="18 convert case form to table form | BIO4558 Biostatistiques appliquées avec R" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="18 convert case form to table form | BIO4558 Biostatistiques appliquées avec R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 convert case form to table form | BIO4558 Biostatistiques appliquées avec R" />
  
  
  

<meta name="author" content="Julien Martin" />


<meta name="date" content="2019-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html"/>
<link rel="next" href="fit-full-model.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quelques-points-importants-a-retenir"><i class="fa fa-check"></i>Quelques points importants à retenir</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quest-ce-que-r-et-pourquoi-lutiliser-dans-ce-cours"><i class="fa fa-check"></i>Qu’est-ce que R et pourquoi l’utiliser dans ce cours?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructions-generales-pour-les-laboratoires"><i class="fa fa-check"></i>Instructions générales pour les laboratoires</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#et-pour-les-dilettantes-ou-ceux-qui-sont-allergiques-a-la-programmation"><i class="fa fa-check"></i>Et pour les dilettantes ou ceux qui sont allergiques à la programmation…</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introductionR.html"><a href="introductionR.html"><i class="fa fa-check"></i><b>1</b> Introduction à R</a><ul>
<li class="chapter" data-level="1.1" data-path="introductionR.html"><a href="introductionR.html#importer-et-exporter-des-donnees"><i class="fa fa-check"></i><b>1.1</b> Importer et exporter des données</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introductionR.html"><a href="introductionR.html#ouvrir-et-sauvegarder-un-fichier-de-donnees-en-format-r"><i class="fa fa-check"></i><b>1.1.1</b> Ouvrir et sauvegarder un fichier de données en format R</a></li>
<li class="chapter" data-level="1.1.2" data-path="introductionR.html"><a href="introductionR.html#entrer-des-donnees"><i class="fa fa-check"></i><b>1.1.2</b> Entrer des données</a></li>
<li class="chapter" data-level="1.1.3" data-path="introductionR.html"><a href="introductionR.html#nettoyercorriger-des-donnees"><i class="fa fa-check"></i><b>1.1.3</b> Nettoyer/corriger des données</a></li>
<li class="chapter" data-level="1.1.4" data-path="introductionR.html"><a href="introductionR.html#importer-des-donnees-a-partir-dexcel."><i class="fa fa-check"></i><b>1.1.4</b> Importer des données à partir d’Excel.</a></li>
<li class="chapter" data-level="1.1.5" data-path="introductionR.html"><a href="introductionR.html#exporter-des-donnees-a-partir-de-r."><i class="fa fa-check"></i><b>1.1.5</b> Exporter des données à partir de R.</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introductionR.html"><a href="introductionR.html#examen-preliminaire-des-donnees"><i class="fa fa-check"></i><b>1.2</b> Examen préliminaire des données</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introductionR.html"><a href="introductionR.html#sommaire-statistique"><i class="fa fa-check"></i><b>1.2.1</b> Sommaire statistique</a></li>
<li class="chapter" data-level="1.2.2" data-path="introductionR.html"><a href="introductionR.html#histogramme-densite-de-probabilite-empirique-boxplot-et-examen-visuel-de-la-normalite"><i class="fa fa-check"></i><b>1.2.2</b> Histogramme, densité de probabilité empirique, boxplot et examen visuel de la normalité</a></li>
<li class="chapter" data-level="1.2.3" data-path="introductionR.html"><a href="introductionR.html#diagrammes-de-dispersion-bivaries"><i class="fa fa-check"></i><b>1.2.3</b> Diagrammes de dispersion bivariés</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introductionR.html"><a href="introductionR.html#creer-des-sous-ensembles-de-cas"><i class="fa fa-check"></i><b>1.3</b> Créer des sous-ensembles de cas</a></li>
<li class="chapter" data-level="1.4" data-path="introductionR.html"><a href="introductionR.html#transformations-de-donnees"><i class="fa fa-check"></i><b>1.4</b> Transformations de données</a></li>
<li class="chapter" data-level="1.5" data-path="introductionR.html"><a href="introductionR.html#exercice"><i class="fa fa-check"></i><b>1.5</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><i class="fa fa-check"></i><b>2</b> Analyse de puissance avec R et G*Power ahahahaha</a><ul>
<li class="chapter" data-level="2.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#la-theorie"><i class="fa fa-check"></i><b>2.1</b> La théorie</a><ul>
<li class="chapter" data-level="2.1.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#quest-ce-que-la-puissance"><i class="fa fa-check"></i><b>2.1.1</b> Qu’est-ce que la puissance?</a></li>
<li class="chapter" data-level="2.1.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#pourquoi-faire-une-analyse-de-puissance"><i class="fa fa-check"></i><b>2.1.2</b> Pourquoi faire une analyse de puissance?</a></li>
<li class="chapter" data-level="2.1.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#facteurs-qui-affectent-la-puissance"><i class="fa fa-check"></i><b>2.1.3</b> Facteurs qui affectent la puissance</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#quest-ce-que-gpower"><i class="fa fa-check"></i><b>2.2</b> Qu’est ce que G*Power?</a></li>
<li class="chapter" data-level="2.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#comment-utiliser-gpower"><i class="fa fa-check"></i><b>2.3</b> Comment utiliser G*Power</a><ul>
<li class="chapter" data-level="2.3.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#principe-general"><i class="fa fa-check"></i><b>2.3.1</b> Principe général</a></li>
<li class="chapter" data-level="2.3.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#types-danalyses-de-puissance-disponibles"><i class="fa fa-check"></i><b>2.3.2</b> Types d’analyses de puissance disponibles</a></li>
<li class="chapter" data-level="2.3.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#comment-calculer-la-taille-de-leffet-gpower-permet-de-faire-une-analyse-de-puissance-pour-de-nombreux-tests-statistiques"><i class="fa fa-check"></i><b>2.3.3</b> Comment calculer la taille de l’effet G*Power permet de faire une analyse de puissance pour de nombreux tests statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#calculs-de-puissance-pour-un-test-de-t-comparant-deux-moyennes-independantes"><i class="fa fa-check"></i><b>2.4</b> Calculs de puissance pour un test de t comparant deux moyennes indépendantes</a><ul>
<li class="chapter" data-level="2.4.1" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#analyse-post-hoc"><i class="fa fa-check"></i><b>2.4.1</b> Analyse post-hoc</a></li>
<li class="chapter" data-level="2.4.2" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#analyse-a-priori"><i class="fa fa-check"></i><b>2.4.2</b> Analyse a priori</a></li>
<li class="chapter" data-level="2.4.3" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#analyse-de-sensitivite"><i class="fa fa-check"></i><b>2.4.3</b> Analyse de sensitivité</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#points-a-retenir"><i class="fa fa-check"></i><b>2.5</b> Points à retenir</a></li>
<li class="chapter" data-level="2.6" data-path="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html"><a href="analyse-de-puissance-avec-r-et-gpower-ahahahaha.html#exercice-1"><i class="fa fa-check"></i><b>2.6</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="correlation-et-regression-lineaire-simple.html"><a href="correlation-et-regression-lineaire-simple.html"><i class="fa fa-check"></i><b>3</b> Corrélation et régression linéaire simple</a></li>
<li class="chapter" data-level="4" data-path="comparaison-de-deux-echantillons.html"><a href="comparaison-de-deux-echantillons.html"><i class="fa fa-check"></i><b>4</b> Comparaison de deux échantillons</a></li>
<li class="chapter" data-level="5" data-path="anova-a-un-critere-de-classification.html"><a href="anova-a-un-critere-de-classification.html"><i class="fa fa-check"></i><b>5</b> ANOVA à un critère de classification</a></li>
<li class="chapter" data-level="6" data-path="but-first-save-current-par-and-set-graphic-page-to-hold-4.html"><a href="but-first-save-current-par-and-set-graphic-page-to-hold-4.html"><i class="fa fa-check"></i><b>6</b> but first, save current par and set graphic page to hold 4</a></li>
<li class="chapter" data-level="7" data-path="anova-a-criteres-multiples-plans-factoriels-et-hierarchiques.html"><a href="anova-a-criteres-multiples-plans-factoriels-et-hierarchiques.html"><i class="fa fa-check"></i><b>7</b> ANOVA à critères multiples : plans factoriels et hiérarchiques</a></li>
<li class="chapter" data-level="8" data-path="but-first-save-current-par-and-set-graphic-page-to-hold-4-1.html"><a href="but-first-save-current-par-and-set-graphic-page-to-hold-4-1.html"><i class="fa fa-check"></i><b>8</b> but first, save current par and set graphic page to hold 4</a></li>
<li class="chapter" data-level="9" data-path="fit-simplified-model.html"><a href="fit-simplified-model.html"><i class="fa fa-check"></i><b>9</b> fit simplified model</a></li>
<li class="chapter" data-level="10" data-path="modified-from-code-written-by-david-c-howell.html"><a href="modified-from-code-written-by-david-c-howell.html"><i class="fa fa-check"></i><b>10</b> modified from code written by David C. Howell</a></li>
<li class="chapter" data-level="11" data-path="httpwww-uvm-edudhowellstatpagesmore-stuffpermuta-.html"><a href="httpwww-uvm-edudhowellstatpagesmore-stuffpermuta-.html"><i class="fa fa-check"></i><b>11</b> <span>http://www.uvm.edu/~dhowell/StatPages/More_Stuff/Permuta-</span></a></li>
<li class="chapter" data-level="12" data-path="bootstrap-1000-time-using-the-residuals-bootstraping.html"><a href="bootstrap-1000-time-using-the-residuals-bootstraping.html"><i class="fa fa-check"></i><b>12</b> Bootstrap 1000 time using the residuals bootstraping</a></li>
<li class="chapter" data-level="13" data-path="regression-multiple.html"><a href="regression-multiple.html"><i class="fa fa-check"></i><b>13</b> Régression multiple</a></li>
<li class="chapter" data-level="14" data-path="bootstrap-analysis-the-simple-way-with-library-simpleboot.html"><a href="bootstrap-analysis-the-simple-way-with-library-simpleboot.html"><i class="fa fa-check"></i><b>14</b> Bootstrap analysis the simple way with library simpleboot</a></li>
<li class="chapter" data-level="15" data-path="define-model-to-be-bootstrapped-and-the-data-source-used.html"><a href="define-model-to-be-bootstrapped-and-the-data-source-used.html"><i class="fa fa-check"></i><b>15</b> Define model to be bootstrapped and the data source used</a></li>
<li class="chapter" data-level="16" data-path="ancova-et-glm.html"><a href="ancova-et-glm.html"><i class="fa fa-check"></i><b>16</b> ANCOVA et GLM</a></li>
<li class="chapter" data-level="17" data-path="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html"><a href="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html"><i class="fa fa-check"></i><b>17</b> Analyse de données de fréquence: Tableaux de contingence, modèles log-linéaires et régression de Poisson</a></li>
<li class="chapter" data-level="18" data-path="convert-case-form-to-table-form.html"><a href="convert-case-form-to-table-form.html"><i class="fa fa-check"></i><b>18</b> convert case form to table form</a></li>
<li class="chapter" data-level="19" data-path="fit-full-model.html"><a href="fit-full-model.html"><i class="fa fa-check"></i><b>19</b> Fit full model</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIO4558 Biostatistiques appliquées avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="convert-case-form-to-table-form" class="section level1">
<h1><span class="header-section-number">18</span> convert case form to table form</h1>
<p>xtabs(~ageclass+sex,USPopSurvey.caseform)
sex
ageclass female male
0-9
17619 17538
10-19 17947 18207
20-29 21344 21401
30-39 19138 18837
40-49 13135 12568
50-59 11617 10661
60-69 11053 9374
70-79
7712 5348
80+
4114 1926
# convert frequency form to table form
xtabs(frequency~ageclass+sex, data=USPopSurvey)
sex
ageclass female male
0-9
17619 17538
10-19 17947 18207
20-29 21344 21401
30-39 19138 18837
40-49 13135 12568
50-59 11617 10661
60-69 11053 9374
70-79
7712 5348
80+
4114 1926
Figure 1. Fonctions permettant la conversion
de données de fréquences entre les différents
formats.
à ce format
De ce format
Cas
Cas
Fréquence expand.dft(X)
Tableau expand.dft(X)
Fréquence Tableau
xtabs(~A+B) table(A,B)
xtabs(count~A+B)
as.data.frame(X)
GraphiquesVisualiser graphiquement les
tableaux de contingence et test
d’indépendance
Les tableaux de contingence peuvent servir à éprouver l’hypothèse
d’indépendance des observations. Ceci équivaut à répondre à la
question: est-ce que la classification des observations selon une
variable (par exemple sex) indépendante de la classification par une
autre variable (par exemple ageclass). En autres mots, est-ce que la
proportion des mâles et femelles indépendante de l’âge ou varie avec
l’âge?
Le package vcd inclut la fonction mosaic() qui permet de représenter
graphiquement le contenu d’un tableau de contingence:
library(vcd)
USTable&lt;-xtabs(frequency~ageclass+sex, data=USPopSurvey) # save the table
form as USTable dataframe
# Mosaic plot of the contingency table
mosaic(USTable)</p>
<p>Figure 2.
Cette mosaïque représente la proportion des observations dans
chaque combinaison de catégories (ici il y a 18 catégories, 2 sexes x 9
classes d’âge). Les catégories contenant une plus grande proportion
d’observations sont représentées par de plus grands rectangles.
Visuellement, on peut voir que la proportion des mâles et femelles est
approximativement égale chez les jeunes, mais que la proportion des
femelles augmente chez les personnes âgées.
Le test de Chi carré permet d’éprouver l’hypothèse nulle que la
proportion des mâles et femelles ne change pas avec l’âge (est
indépendante de l’âge):
# Test of independence
chisq.test(USTable) # runs chi square test of independence of sex and age
class
Pearson’s Chi-squared test
data: USTable
X-squared = 1162.584, df = 8, p-value &lt; 2.2e-16
La valeur p étant très faible, on rejette donc l’hypothèse nulle que âge
et sexe sont indépendants.
Ces graphiques mosaïques peuvent êtres colorés pour souligner les
catégories qui contribuent le plus à cette dépendance:
# Mosaic plot of the contingency table with shading
mosaic(USTable, shade=TRUE)</p>
<p>Figure 3.
La couleur de chaque rectangle est proportionnelle à la déviation des
fréquences observées de ce qui serait attendu si l’âge et le sexe étaient
indépendants. Les classes d’âge 40-49 et 50-59 ont un rapport des sexe
approximativement égal à celui de toutes les classes d’âge réunies. Il y
a plus de jeunes mâles et de femelles âgées que si le rapport des sexe
ne variait pas avec l’âge.et ces rectangles sont colorés en bleu. De
l’autre côté, il y a moins de jeunes femelles et de mâles âgés que si le
rapport des sexe était indépendant de l’âge, et ces rectangles sont en
rouge. La valeur p à la droite de la figure est pour le test de Chi carré
qui éprouve l’hypothèse nulle d’indépendance pour l’ensemble des
observations, toutes classes d’âge confondues.
L’estimation de la valeur p associée à la statistique du Chi carré est
approximative lorsque les fréquences attendues sont faibles dans
certaines cellules, et ce particulièrement pour les tableaux de
contingence 2x2. Deux options permettant des valeurs p plus exactes
sont préférées dans ce cas, et le choix dépends du nombre total
d’observations. Pour de grands échantillons (comme ici avec plus de
200,000 observations!), une approche par simulation de type Monte
Carlo est suggérée et peut être obtenue en ajoutant
simulate.p.value=TRUE comme argument à la fonction chisq.test() :
# Monte-carlo estimation of p value (better for small n)
chisq.test(USTable, simulate.p.value=TRUE, B=10000)
Pearson’s Chi-squared test with simulated p-value (based on 10000
replicates)</p>
<p>data: USTable
X-squared = 1162.584, df = NA, p-value = 9.999e-05
Ici, la simulation a été faite B=10000 fois, et la valeur de Chi carré
observée avec les données réelles n’a jamais été observée. Par
conséquent, p a été estimé à 1/10001=9.999e-05, qui est beaucoup
plus élevé que la valeur p estimée à partir de la distribution théorique
de Chi carré (p&lt; 2.2e-16). Cette différence est due au moins en partie
à un artéfacts de la simulation. Pour obtenir des valeurs p de l’ordre de
1e-16, il faut effectuer au moins 10 16 simulations. Et je ne suis pas
aussi patient que ça!
Pour de petits tableaux de contingence avec des fréquences attendues
petites, le test exact de Fisher peut servir à estimer la valeur p associée
à l’hypothèse d’indépendance. Mais ce test ne peut être effectué avec
de grands échantillons, comme ici:
&gt; #Fisher exact test for contingency tables (small samples and small tables)
&gt; fisher.test(USTable) # fails here because too many observations
Error in fisher.test(USTable) : FEXACT error 40.
Out of workspace.
&gt; fisher.test(USTable, simulate.p.value=TRUE, B=10000)
Fisher’s Exact Test for Count Data with simulated p-value (based on
10000 replicates)
data: USTable
p-value = 9.999e-05
alternative hypothesis: two.sided
Régression de Poisson: une alternative au
test de Chi carré pour les tableaux de
contingence
Rendu à ce stade, vous devriez avoir appris à apprécier la flexibilité et
la généralité des modèles linéaires, et réaliser que le test de t est un cas
spécial d’un modèle linéaire avec une variable indépendante
catégorique. L’analyse des tableaux de contingence par le test du Chi
carré peut également être généralisé. Un modèle linéaire généralisé
pour une distribution de Poisson peut être utilisé quand la variable
dépendante est une fréquence d’observations et les variables
indépendantes sont catégorique (comme pour les tableaux de
contingence, on parle alors de modèles log-linéaires), continue
(régression Poisson), ou une combinaison de variables indépendante
continues et catégoriques (aussi appelé régression de Poisson, mais
avec des variables catégoriques en plus, analogue à l’ANCOVA sensu
largo).
Ces modèles prédisent le logarithme naturel de la fréquence des
observations en fonction des variables indépendantes. Comme pour
les modèles linéaires qui présument de la normalité des résidus, on
peut évaluer la qualité d’ajustement du modèle (par AICc par exemple)</p>
<p>et la signification statistique des termes du modèle (par exemple en
comparant l’ajustement d’un modèle “complet” et celui d’un modèle
qui exclue un terme à tester). On peut également obtenir des estimés
des paramètre pour chaque terme dans le modèle, avec des intervalles
de confiance et des valeur p pour l’hypothèse nulle que ce terme n’a
pas d’influence sur la fréquence.
La fonction glm() avec l’option family=poisson() permet l’estimation,
par la méthode du maximum de vraisemblance, de modèles linéaires
pour des fréquences.
Comparativement aux modèles linéaires vus précédemment, une des
particularité de ces modèles est que seuls les termes d’interaction
sont d’intérêt.
En partant des données de recensement en forme tableau, on peut
ajuster un glm aux fréquences observées par sexe et classe d’âge par:
mymodel&lt;-glm(frequency~sex<em>ageclass,family=poisson(),data=USPopSurvey)
&gt; summary(mymodel)
Call:
glm(formula = frequency ~ sex </em> ageclass, family = poisson(),
data = USPopSurvey)
Deviance Residuals:
[1] 0 0 0 0 0
0
0
0
0
0
0
0
0
0
0
0
0
0
Coefficients:
Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)
9.776733
0.007534 1297.730 &lt; 2e-16
sexmale
-0.004608
0.010667
-0.432
0.6657
ageclass10-19
0.018445
0.010605
1.739
0.0820
ageclass20-29
0.191793
0.010179
18.842 &lt; 2e-16
ageclass30-39
0.082698
0.010441
7.921 2.36e-15
ageclass40-49
-0.293697
0.011528 -25.477 &lt; 2e-16
ageclass50-59
-0.416508
0.011951 -34.850 &lt; 2e-16
ageclass60-69
-0.466276
0.012134 -38.428 &lt; 2e-16
ageclass70-79
-0.826200
0.013654 -60.511 &lt; 2e-16
ageclass80+
-1.454582
0.017316 -84.004 &lt; 2e-16
sexmale:ageclass10-19 0.018991
0.014981
1.268
0.2049
sexmale:ageclass20-29 0.007275
0.014400
0.505
0.6134
sexmale:ageclass30-39 -0.011245
0.014803
-0.760
0.4475
sexmale:ageclass40-49 -0.039519
0.016416
-2.407
0.0161
sexmale:ageclass50-59 -0.081269
0.017136
-4.742 2.11e-06
sexmale:ageclass60-69 -0.160154
0.017633
-9.083 &lt; 2e-16
sexmale:ageclass70-79 -0.361447
0.020747 -17.422 &lt; 2e-16
sexmale:ageclass80+
-0.754343
0.029598 -25.486 &lt; 2e-16
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’
<strong><em>
.
</em></strong>
<strong><em>
</em></strong>
<strong><em>
</em></strong>
<strong><em>
</em></strong>
<em>
</em><strong>
</strong><em>
</em><strong>
</strong>*
1
(Dispersion parameter for poisson family taken to be 1)
Null deviance: 5.3611e+04
Residual deviance: -1.6116e-12
AIC: 237.31
on 17
on 0
degrees of freedom
degrees of freedom
Number of Fisher Scoring iterations: 2</p>
<p>L’ajustement du modèle complet, avec L’interaction triple sex:ageclass
interaction, permet à la proportion des mâles et femelles de changer
entre les classes d’âge, et donc d’estimer exactement les fréquences
observées pour chaque combinaison de sexe et classe d’âge (notez que
les résidus (deviance residuals) sont tous 0, et que l’estimé de déviance
résiduelle est également approximativement zéro).
Un masochiste peut utiliser le tableau des coefficients pour obtenir la
fréquence prédite pour les différentes catégories. Les fréquences
prédites, comme pour l’ANOVA à critères multiple, sont obtenus en
additionnant les coefficients appropriés. Puisque, en R, le premier
niveau d’une variable catégorique (facteur) en ordre alphabétique) est
utilisé comme référence, l’ordonnée à l’origine (9.776733) est la valeur
prédite pour le logarithme naturel de la fréquence des femelles dans la
première classe d’âge (0 to 9). En effet, 9.776733 est approximativement
égal à 17619, le nombre observé de femelles dans cette classe d’âge.
Pour les mâles dans la classe d’âge 80+, il faut calcule l’antilog du
coefficient pour l’ordonnée à l’origine (pour les femelles dans la
première classe d’âge), plus le coefficient pour sexmale (égal à la
différence du log de la fréquence entre les femelles et les mâles), plus
le coefficient pour la classe d’âge 80+ qui corresponds à la différence
de fréquence entre cette classe d’âge et la classe d’âge de référence,
plus le coefficient pour l’interaction sexmale:ageclass80+ (qui
corresponds à la différence de proportion de mâles dans cette classe
d’âge par rapport à la classe d’âge de référence). Ceci donne:
ln(frequency)=9.776733-0.004608-1.454582-0.754343=7.5632, et la
fréquence est égale à e 7.5632 =1926
Il y a de nombreuses valeur p dans ce tableau, mais elle ne sont en
général pas très utiles. Pour éprouver l’hypothèse que l’effet du sexe
sur la fréquence est identique dans chaque classe d’âge (i.e. que sexe et
âge sont indépendants), vous devez ajuster un modèle qui exclut cette
interaction (sex:ageclass) et déterminer comment l’ajustement du
modèle est affecté.
La fonction Anova() du package car permet de prendre un raccourci:
&gt; library(car)
&gt; Anova(mymodel, type=3, test = “LR”)
Analysis of Deviance Table (Type III tests)
Response: frequency
LR Chisq Df Pr(&gt;Chisq)
sex
0.2 1
0.6657
ageclass
21074.6 8
&lt;2e-16 <strong><em>
sex:ageclass
1182.2 8
&lt;2e-16 </em></strong>
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1</p>
<p>Les arguments type=3 and test=“LR” font en sorte que le test
effectué pour comparer le modèle complet aux modèles réduits est les
test de Chi carré sur le rapport de vraisemblance (Likelihood Ratio
Chi-Square) à partir de la variance résiduelle, et que c’est un test
partiel, et non séquentiel.
Selon ces tests, il n’y a pas d’effet principal de sex (p=0.667) mais il y a
un effet principal de ageclass et une interaction significative
sex:ageclass. L’interaction significative signifie que l’effet du sexe sur
la fréquence varie selon les classes d’âge, bref que le rapport des sexe
varie avec l’âge. L’effet principal de ageclass signifie que la fréquence
des individus varie avec l’âge dans la population recensée (i.e. que
certaines classes d’âge sont plus populeuses que d’autres). L’absence
d’un effet principal du sexe suggère qu’il y a approximativement le
même nombre de mâles et femelles dans l’échantillon (quoique,
puisqu’il y a une interaction, vous devez être prudents en faisant cette
déclaration. C’est “vrai” au total, mais semble incorrect pour certaines
classes d’âge).
Tester une hypothèse extrinsèque
Le test d’indépendance ci-dessus éprouve une hypothèse intrinsèque
parce que les proportions utilisées pour calculer les valeurs attendues
et tester l’indépendance sont celles observées (i.e. la proportion des
mâles et femelles dans tout l’échantillon, et la proportion des individus
dans chaque classe d’âge).
Pour éprouver l’hypothèse (extrinsèque) que le rapport des sexes est
1:1 pour les individus les plus jeunes (ageclass 0-9), on doit produire le
tableau 2X2 des fréquences observées et attendues. Les fréquences
attendues sont obtenues simplement en divisant le total des mâles et
femelles par 2.
Code R pour créer et analyser un tableau de contingence
2X2 et éprouver une hypothèse extrinsèque
### Produce a table of obs vs exp for 0-9 age class
Popn0.9 &lt;- rbind(c(17578, 17578), c(17619, 17538))
### Run X2 test on above table
chisq.test(Popn0.9, correct=F)### X2 without Yates
chisq.test(Popn0.9) ### X2 with Yates
 Éprouvez l’hypothèse nulle que la proportion de mâles et femelles à la
naissance est égale. Que concluez-vous? Croyez-vous que ces données
sont appropriées pour tester cette hypothèse?</p>
<blockquote>
<p>chisq.test(Popn0.9, correct=F)### X2 without Yates
Pearson’s Chi-squared test
data: Popn0.9
X-squared = 0.0933, df = 1, p-value = 0.76
chisq.test(Popn0.9) ### X2 with Yates
Pearson’s Chi-squared test with Yates’ continuity correction
data: Popn0.9
X-squared = 0.0888, df = 1, p-value = 0.7658
Notez que pour un tableau 2X2, on devrait utiliser une correction de
Yates ou un test de Fisher. Le test de Fisher ne pouvant être utilisé
lorsque l’échantillon dépasse 200, on utilise la correction de Yates.
Selon cette analyse, on accepte l’hypothèse nulle que le rapport des
sexes est 1:1à la naissance. Ceci dit, ces données ne sont pas très
appropriées pour éprouver l’hypothèse car la première classe d’âge est
trop grossière. Il est possible que le rapport des sexes à la naissance
soit différent de 1:1 mais que la mortalité différentielle des deux sexes
compense au cours des 9 premières années (par exemple si il y a plus
de mâles à la naissance, mais que les jeunes garçons ont une survie
plus faible au cours de leurs 9 premières années). Dans un tel cas, le
rapport des sexes n’est PAS de 1:1 à la naissance, mais on accepte
l’hypothèse nulle à partir des données dans la classe d’âge 0-9.
Régression de Poisson pour l’analyse de
tableaux de contingence à plusieurs critères
Le principe d’éprouver l’indépendance en examinant les interactions
peut être utilisé avec les tableaux de contingence à plusieurs critères.
Par exemple, examinons si la température (2 niveaux: base et haute) et
l’éclairage (2 niveaux: bas et haut) affectent si des plantes sont
infectées (2 niveaux: infecté et non-infecté) par un pathogène. On
peut représenter ces données par un tableau de contingence à 3
critères (température, lumière, statut d’infection).
L’ajustement de modèles log-linéaires à des données de fréquence
implique que l’on éprouve plusieurs modèles en les comparant au
modèle complet (saturé). Une série de modèles contenant tous les
termes sauf une des interactions qui nous intéressent est produite, et
l’ajustement de chaque modèle est comparé à celui du modèle
complet. Si la réduction de la qualité d’ajustement n’est pas
significative, cela implique que l’interaction manquante contribue peu
à la qualité de l’ajustement. Par contre, si le modèle réduit s’ajuste
nettement moins bien aux données, alors l’interaction manquante</p>
</blockquote>
<p>contribue beaucoup à l’ajustement du modèle complet. Comme pour
les tableaux de contingence 2X2, les termes qui nous intéressent le
plus sont les interactions, pas les effets principaux, si l’on teste pour
l’indépendance des différents facteurs.
Le fichier loglin.Rdata contient les fréquences ( frequency ) des
plantes infectées ou non infectées ( infected ) à basse et haute
température ( temperature) à basse et haute lumière ( light). Pour
visualiser ces données et déterminer si le taux d’infection dépends de
la lumière et de la température, on peut faire une figure mosaïque et
ajuster un modèle log-linéaire:
# Convert from frequency form to table form for mosaic plot
loglinTable&lt;-xtabs(frequency~temperature+light+infected, data=loglin)
# Create mosaic plot to look at data
library(vcd)
mosaic(loglinTable, shade=TRUE)
Figure 4.
Cette expérience contrôlée avec le même nombre de plantes à chaque
niveau de lumière et de température produit une mosaïque où la
surface occupée par les observations dans les quatre quadrants est
égale. Ce qui nous intéresse, le taux d’infection par le pathogène,
semble varier entre les quadrants (i.e. les niveaux de température et de
lumière). Le rectangle rouge dans le coin en bas à gauche indique que
le nombre de plantes infectées à basse température et haute lumière
est plus faible qu’attendu si ces deux facteurs n’influencent pas le taux
d’infection. Même chose pour les conditions de basse lumière et de
haute température (coin supérieur droit). La valeur p au bas de
l’échelle représente un test d’indépendance équivalent à comparer le
modèle complet au modèle excluant toutes les interactions et ne
contenant que les effets principaux de la température, la lumière, et le
statut d’infection sur le logarithme naturel du nombre d’observations.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analyse-de-donnees-de-frequence-tableaux-de-contingence-modeles-log-lineaires-et-regression-de-poisson.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fit-full-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
